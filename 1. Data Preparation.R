data = read.csv("~/Desktop/DSO530 Applied Modern Statistical Learning Methods/Final Project/raw data/train_selectedData.csv")
library(dplyr)

##------------------
  
## OsSuite
data$OsSuite = as.character(data$OsSuite)
data$OsSuite = ifelse(!(data$OsSuite %in% c('768', '256')), 'others', data$OsSuite)

data %>% group_by(OsSuite) %>% summarise(count = n()) -> d                      
d
d %>% mutate(perc = count/sum(count))

# SkuEdition
data$SkuEdition = as.character(data$SkuEdition)
data$SkuEdition = ifelse(!(data$SkuEdition %in% c('Home', 'Pro')), 'others', data$SkuEdition)

data %>% group_by(SkuEdition) %>% summarise(count = n()) -> d                      
d
d %>% mutate(perc = count/sum(count))

# SmartScreen
data %>% group_by(SmartScreen) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$SmartScreen = as.character(data$SmartScreen)
data$SmartScreen = ifelse(!(data$SmartScreen %in% varlist), 'others', data$SmartScreen)
data$SmartScreen = ifelse(data$SmartScreen == "", 'NA', data$SmartScreen)

data %>% group_by(SmartScreen) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_MDC2FormFactor
data %>% group_by(Census_MDC2FormFactor) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_MDC2FormFactor = as.character(data$Census_MDC2FormFactor)
data$Census_MDC2FormFactor = ifelse(!(data$Census_MDC2FormFactor %in% varlist), 'others', data$Census_MDC2FormFactor)

data %>% group_by(Census_MDC2FormFactor) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_PrimaryDiskTypeName
data %>% group_by(Census_PrimaryDiskTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_PrimaryDiskTypeName = as.character(data$Census_PrimaryDiskTypeName)
data$Census_PrimaryDiskTypeName = ifelse(!(data$Census_PrimaryDiskTypeName %in% c('HDD', 'SSD')), 
                                         'others', data$Census_PrimaryDiskTypeName)

data %>% group_by(Census_PrimaryDiskTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_ChassisTypeName
data %>% group_by(Census_ChassisTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_ChassisTypeName = as.character(data$Census_ChassisTypeName)
data$Census_ChassisTypeName = ifelse(!(data$Census_ChassisTypeName %in% varlist), 
                                         'others', data$Census_ChassisTypeName)

data %>% group_by(Census_ChassisTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_PowerPlatformRoleName
data %>% group_by(Census_PowerPlatformRoleName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_PowerPlatformRoleName = as.character(data$Census_PowerPlatformRoleName)
data$Census_PowerPlatformRoleName = ifelse(!(data$Census_PowerPlatformRoleName %in% varlist), 
                                     'others', data$Census_PowerPlatformRoleName)

data %>% group_by(Census_PowerPlatformRoleName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_OSSkuName
data %>% group_by(Census_OSSkuName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_OSSkuName = as.character(data$Census_OSSkuName)
data$Census_OSSkuName = ifelse(!(data$Census_OSSkuName %in% varlist), 
                                           'others', data$Census_OSSkuName)

data %>% group_by(Census_OSSkuName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_OSInstallTypeName
data %>% group_by(Census_OSInstallTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_OSInstallTypeName = as.character(data$Census_OSInstallTypeName)
data$Census_OSInstallTypeName = ifelse(!(data$Census_OSInstallTypeName %in% varlist), 
                               'others', data$Census_OSInstallTypeName)
data %>% group_by(Census_OSInstallTypeName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_OSWUAutoUpdateOptionsName
data %>% group_by(Census_OSWUAutoUpdateOptionsName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_OSWUAutoUpdateOptionsName = as.character(data$Census_OSWUAutoUpdateOptionsName)
data$Census_OSWUAutoUpdateOptionsName = ifelse(!(data$Census_OSWUAutoUpdateOptionsName %in% varlist), 
                                       'others', data$Census_OSWUAutoUpdateOptionsName)

data %>% group_by(Census_OSWUAutoUpdateOptionsName) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_ActivationChannel
data %>% group_by(Census_ActivationChannel) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_ActivationChannel = as.character(data$Census_ActivationChannel)
data$Census_ActivationChannel = ifelse(!(data$Census_ActivationChannel %in% varlist), 
                                               'others', data$Census_ActivationChannel)
data %>% group_by(Census_ActivationChannel) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

# Census_OSBranch
data %>% group_by(Census_OSBranch) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d
d %>% mutate(perc = count/sum(count)) ->dd
dd
var = dd[dd[,3]>0.01,1]
varlist = as.vector(var[[1]]) 
varlist

data$Census_OSBranch = as.character(data$Census_OSBranch)
data$Census_OSBranch = ifelse(!(data$Census_OSBranch %in% varlist), 
                                       'others', data$Census_OSBranch)
data %>% group_by(Census_OSBranch) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d


# Census_PrimaryDiskTotalCapacity
data$Census_PrimaryDiskTotalCapacity = as.numeric(data$Census_PrimaryDiskTotalCapacity)

data$Census_PrimaryDiskTotalCapacity = data$Census_PrimaryDiskTotalCapacity/1024

data$Census_PrimaryDiskTotalCapacity = ifelse(data$Census_PrimaryDiskTotalCapacity <= 32, '32',
                                              ifelse(data$Census_PrimaryDiskTotalCapacity <= 64, '64',
                                                     ifelse(data$Census_PrimaryDiskTotalCapacity <= 128, '128',
                                                            ifelse(data$Census_PrimaryDiskTotalCapacity <= 256, '256',
                                                                   ifelse(data$Census_PrimaryDiskTotalCapacity <= 512, '512',
                                                                          ifelse(data$Census_PrimaryDiskTotalCapacity <= 1024, '1024',
                                                                                 ifelse(data$Census_PrimaryDiskTotalCapacity <= 2048, '2048', '>2048')))))))

data %>% group_by(Census_PrimaryDiskTotalCapacity) %>% summarise(count = n()) %>% arrange(-count) -> d                      
d

write.csv(data, 'test_forEncodingNew.csv',row.names = FALSE)