# Microsoft-Malware-Prediction

### Introduction

It is not just an inconvenience when personal devices become infected by various families of malware, but also a security liability when important information like passwords, social security numbers or credit card numbers are potentially stolen. Moreover, malware such as computer viruses, worms and Trojan viruses may all cause serious damage on enterprises and their customers. 

To minimize the risk, understanding the driving factors behind machines getting infected by harmful software is important not only to us but also to technology companies such as Microsoft. Therefore, we decided to choose the Microsoft Malware Prediction Challenge to better understand this problem and dive deeper into the data in order to find out how to prevent machines from getting infected by malware and protect machines from these attacks before it happens.

The dataset provided from Microsoft included different machine properties which are related to the hardware and software of the individual machine. Based on these properties, we can try to make insights as to why some machines with particular properties are more likely to get infected by malware. We also try to build a robust prediction model to predict whether machines will get infected or not in the future. 

By leveraging the power of data, Microsoft can prevent malware from infecting their customers’ devices in order to keep their customers’ hardware safe. This will ultimately improve user experience of their customers and prevent customers from getting hurt by criminals.


### Data Description

The original raw data provided by Microsoft includes 8,921,483 observations and 83 variables. Each row corresponds to an individual machine and is uniquely identified by a machine ID, the MachineIdentifier. Machine properties related to the hardware and software of each machine are also included. The variable HasDetections indicates that malware was detected on the machine.  

Using the information related to the properties as predictors and the labels as responses of each machine in training data, we are able to predict whether each machine in the test data will get infected by malware.


### Approaches

#### Data preparation

Before using R to conduct the data cleaning process, we first do research to dive deeper into each variable and utilize domain knowledge to remove some irrelevant variables manually. Also, we remove the variables with low-variance.

Regarding columns with N/A values, we remove those with over 50% N/A values and divide the remaining variables into 3 types: numerical, binary and categorical variables. Numerical and binary variables can can be used as input directly when building up our classification model. Regarding categorical variables, we apply different encoding methods to transform categorical variables. First, we determine levels that each variable has, identify the frequency of each level and combine levels with smaller quantities together. Later, we apply dummy encoding to variables with 6 or less level and mean encoding to the remaining variables.

After the data preparation process, we generate 54 variables for the following analysis. 


#### Subset Selection

Before directly inputting data into our classification model, we perform subset selection first to select the features which are important in our model and reduce the model complexity. We apply the Lasso to shrink the regression coefficients towards zero and use cross-validation to select the optimal value of lambda. There are 38 key variables selected.


#### Model Building

After selecting the best subset, we conduct different approaches such as Logistic Regression, LDA, XGboosting and Random Forest to build up our classification model. We choose our final model based on each test error rate.

We choose the subset selected by the Lasso as input features and build up our final prediction model using Random Forest approach.


### Results

#### Model Accuracy Rate

The resulting accuracy rate from our final Random Forest model was 65.7%. From our ROC curve, we check the true positive rate versus the false positive rate of our predictions for machines with HasDetections and can see that the threshold we tested at 0.5 is indeed the best threshold to use for maximum accuracy, as shown with the green dashed line. The resulting AUC, the area under the ROC is approximately 65.6%.  

#### Business Insights

- Anti-Malware Options

Under the ExistsNotSet, more devices had positive malware detections where Smart Screen exists but wasn’t set up. In contrast, in the RequireAdmin category, where users have actively set up SmartScreen, there is a significant decrease in machines with malware detected. Thus, we recommend Microsoft to subtly educate users on already built-in antivirus protection options and to urge users to opt-in to the latest anti-malware protection programs. 

- Locations

Location may have an impact on malware infection as some cities and countries are targeted specifically or more so than others. Therefore, our recommendation is that computers sold in these regions should have Windows Defender to automatically update or urge users to opt-in rather than turn off the feature.

- Hardware and Software

Newer machines may have more defenses already built in, and therefore are more equipped to detect malware. However, Microsoft has limited power to change the fact that specific OEM models are more susceptible to malware attacks. Thus, we recommend that Microsoft should continue to invest their resources into updating their antivirus protection to the best of their ability. 
